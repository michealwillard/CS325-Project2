Algorithm 3: changedp